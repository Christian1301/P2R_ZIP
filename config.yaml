# ========================================
# CONFIGURAZIONE P2R+ZIP
# ========================================

RUN_NAME: "jhu_p2rzip_v1"   # Nome esperimento -> exp/jhu_p2rzip_v1
SEED: 2024
DEVICE: "cuda"               # "cuda" o "cpu"

# === DATASET ===
DATASET: "jhu"               # "jhu", "ucf", "shha", "nwpu"
DATA:
  ROOT: "/mnt/localstorage/datasets/jhu_crowd_v2"   # root dataset
  ZIP_BLOCK_SIZE: 32          # dimensione blocchi ZIP
  IMG_EXTS: [".jpg", ".png"]
  NORM_MEAN: [0.485, 0.456, 0.406]
  NORM_STD:  [0.229, 0.224, 0.225]
  TRAIN_SPLIT: "train"
  VAL_SPLIT: "val"

# === MODELLO ===
MODEL:
  BACKBONE: "vgg16_bn"       # "vgg16_bn" o "resnet50"
  ZIP_PI_THRESH: 0.5
  GATE: "multiply"           # "multiply" o "concat"
  UPSAMPLE_TO_INPUT: true

# === TRAINING ===
OPTIM:
  BATCH_SIZE: 4
  NUM_WORKERS: 4
  EPOCHS: 300
  LR: 1.0e-4
  WEIGHT_DECAY: 1.0e-4
  VAL_INTERVAL: 10           # valida ogni N epoche
  RESUME_LAST: true          # riprendi da ultimo checkpoint se esiste

# === LOSS ===
LOSS:
  JOINT_ALPHA: 1.0           # peso della loss P2R nella fase 3 (congiunta)
  P2R_SIGMA: 4.0
  COUNT_L1_W: 0.01

# === ESPERIMENTO ===
EXP:
  OUT_DIR: "exp"
  SAVE_BEST: true
